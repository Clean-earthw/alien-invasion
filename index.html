<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <title>WebAR Robot Shooter</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        margin: 0;
        overflow: hidden;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        background-color: #000;
      }

      #scene-container {
        width: 100vw;
        height: 100vh;
        position: fixed;
        top: 0;
        left: 0;
      }

      #loading {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: white;
        font-size: 24px;
        text-align: center;
        z-index: 1000;
        background-color: rgba(0, 0, 0, 0.9);
        padding: 30px;
        border-radius: 15px;
        border: 2px solid #22c55e;
        min-width: 300px;
      }

      .spinner {
        border: 4px solid rgba(255, 255, 255, 0.3);
        border-top: 4px solid #22c55e;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        animation: spin 1s linear infinite;
        margin: 20px auto;
      }

      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }

      /* HUD Styles */
      .hud-container {
        display: flex;
        flex-direction: column;
        padding: 15px;
        background: linear-gradient(135deg, rgba(0, 0, 0, 0.9), rgba(20, 0, 40, 0.9));
        border-radius: 12px;
        border: 2px solid;
        border-image: linear-gradient(45deg, #ff0000, #00ff00, #0000ff) 1;
        gap: 10px;
        backdrop-filter: blur(10px);
        position: fixed;
        top: 20px;
        right: 20px;
        min-width: 200px;
        z-index: 1000;
      }

      .game-title {
        font-size: 22px;
        font-weight: bold;
        background: linear-gradient(90deg, #ff0000, #00ff00, #0000ff);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        text-align: center;
        margin-bottom: 5px;
        text-transform: uppercase;
        letter-spacing: 2px;
      }

      .stat-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 12px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 8px;
        border-left: 3px solid;
      }

      .score-row {
        border-left-color: #ff0000;
      }

      .wave-row {
        border-left-color: #00ff00;
      }

      .kills-row {
        border-left-color: #0000ff;
      }

      .health-row {
        border-left-color: #ff9900;
      }

      .stat-label {
        font-size: 16px;
        color: #ffffff;
        font-weight: 500;
      }

      .stat-value {
        font-size: 20px;
        font-weight: bold;
        font-family: 'Courier New', monospace;
        text-shadow: 0 0 10px currentColor;
      }

      .score-value {
        color: #ff0000;
      }

      .wave-value {
        color: #00ff00;
      }

      .kills-value {
        color: #0000ff;
      }

      .health-value {
        color: #ff9900;
      }

      /* Health Bar Styles */
      .health-bar-container {
        margin-top: 5px;
      }

      .health-bar-label {
        display: flex;
        justify-content: space-between;
        font-size: 14px;
        color: #ffffff;
        margin-bottom: 4px;
      }

      .health-bar {
        width: 100%;
        height: 12px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 6px;
        overflow: hidden;
        border: 1px solid rgba(255, 153, 0, 0.3);
      }

      .health-bar-fill {
        height: 100%;
        background: linear-gradient(90deg, #ff0000, #ff9900, #00ff00);
        border-radius: 6px;
        transition: width 0.3s ease, background 0.3s ease;
        position: relative;
        overflow: hidden;
      }

      .health-bar-fill::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(90deg, 
          transparent 0%, 
          rgba(255, 255, 255, 0.2) 50%, 
          transparent 100%);
        animation: shimmer 2s infinite;
      }

      @keyframes shimmer {
        0% { transform: translateX(-100%); }
        100% { transform: translateX(100%); }
      }

      .health-bar-text {
        font-size: 12px;
        color: #ffffff;
        text-align: center;
        margin-top: 3px;
        font-family: 'Courier New', monospace;
      }

      /* DOM Controls */
      .dom-controls {
        position: fixed;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        display: flex;
        gap: 10px;
        z-index: 100;
        pointer-events: auto;
      }

      .dom-controls button {
        padding: 12px 24px;
        background-color: rgba(34, 197, 94, 0.8);
        color: white;
        border: none;
        border-radius: 8px;
        font-size: 16px;
        font-weight: bold;
        cursor: pointer;
        border: 2px solid #22c55e;
        transition: all 0.2s;
      }

      .dom-controls button:hover {
        background-color: rgba(34, 197, 94, 1);
        transform: scale(1.05);
      }

      .dom-controls button:active {
        transform: scale(0.95);
      }

      .dom-controls button.bomb {
        background-color: rgba(239, 68, 68, 0.8);
        border-color: #ef4444;
      }

      .dom-controls button.bomb:hover {
        background-color: rgba(239, 68, 68, 1);
      }

      @keyframes pulse {
        0% { opacity: 1; }
        50% { opacity: 0.5; }
        100% { opacity: 1; }
      }
    </style>
    <script type="module" crossorigin src="https://github.com/Clean-earthw/alien-invasion/assets/index-CIhWVJCo.js"></script>
  </head>
  <body>
    <div id="scene-container"></div>
    
    <!-- HUD -->
    <div class="hud-container">
      <div class="game-title">SPACE INVASION</div>
      
      <div class="stat-row score-row">
        <span class="stat-label">SCORE</span>
        <span id="score-value" class="stat-value score-value">0</span>
      </div>
      
      <div class="stat-row wave-row">
        <span class="stat-label">WAVE</span>
        <span id="wave-value" class="stat-value wave-value">1</span>
      </div>
      
      <div class="stat-row kills-row">
        <span class="stat-label">ELIMINATED</span>
        <span id="kills-value" class="stat-value kills-value">0</span>
      </div>
      
      <div class="stat-row health-row">
        <span class="stat-label">HEALTH</span>
        <span id="health-value" class="stat-value health-value">100</span>
      </div>
      
      <div class="health-bar-container">
        <div class="health-bar-label">
          <span>SHIELD INTEGRITY</span>
          <span id="health-percent">100%</span>
        </div>
        <div class="health-bar">
          <div id="health-bar-fill" class="health-bar-fill" style="width: 100%"></div>
        </div>
        <div class="health-bar-text" id="health-status">OPTIMAL</div>
      </div>
    </div>
    
    <!-- Controls -->
    <div class="dom-controls">
      <button id="dom-reload-btn">Reload (R)</button>
      <button id="dom-bomb-btn" class="bomb">Bomb (B)</button>
    </div>
    
    <!-- Loading Screen -->
    <div id="loading">
      <div class="spinner"></div>
      <p>Loading WebAR Robot Shooter...</p>
      <p style="font-size: 14px; margin-top: 10px; color: #aaa;">
        Make sure you're using HTTPS and have WebXR enabled
      </p>
    </div>

    
    <!-- JavaScript -->
    <script>
      // DOM Controls
      document.getElementById('dom-reload-btn').addEventListener('click', () => {
        console.log('DOM Reload button clicked');
        // Dispatch custom event for game systems
        window.dispatchEvent(new CustomEvent('reload-weapon'));
      });
      
      document.getElementById('dom-bomb-btn').addEventListener('click', () => {
        console.log('DOM Bomb button clicked');
        // Dispatch custom event for game systems
        window.dispatchEvent(new CustomEvent('use-bomb'));
      });
      
      // Health bar update function
      function updateHealthBar(current, max) {
        const percentage = (current / max) * 100;
        const healthBar = document.getElementById('health-bar-fill');
        const healthValue = document.getElementById('health-value');
        const healthPercent = document.getElementById('health-percent');
        const healthStatus = document.getElementById('health-status');
        
        // Update values
        healthBar.style.width = `${percentage}%`;
        healthValue.textContent = Math.round(current);
        healthPercent.textContent = `${Math.round(percentage)}%`;
        
        // Update color based on health percentage
        if (percentage > 70) {
          healthBar.style.background = 'linear-gradient(90deg, #00ff00, #00cc00)';
          healthStatus.textContent = 'OPTIMAL';
          healthStatus.style.color = '#00ff00';
        } else if (percentage > 40) {
          healthBar.style.background = 'linear-gradient(90deg, #ff9900, #ff6600)';
          healthStatus.textContent = 'WARNING';
          healthStatus.style.color = '#ff9900';
        } else if (percentage > 20) {
          healthBar.style.background = 'linear-gradient(90deg, #ff3300, #cc0000)';
          healthStatus.textContent = 'CRITICAL';
          healthStatus.style.color = '#ff3300';
        } else {
          healthBar.style.background = 'linear-gradient(90deg, #ff0000, #990000)';
          healthStatus.textContent = 'DANGER';
          healthStatus.style.color = '#ff0000';
          
          // Add pulse animation for critical health
          healthBar.style.animation = 'pulse 0.5s infinite alternate';
        }
        
        // Update health value color
        if (percentage > 60) {
          healthValue.style.color = '#00ff00';
        } else if (percentage > 30) {
          healthValue.style.color = '#ff9900';
        } else {
          healthValue.style.color = '#ff0000';
          healthValue.style.textShadow = '0 0 10px #ff0000';
        }
      }
      
      // Main update function for HUD
      function updateHUD(data) {
        if (data.score !== undefined) {
          document.getElementById('score-value').textContent = data.score;
        }
        if (data.wave !== undefined) {
          document.getElementById('wave-value').textContent = data.wave;
        }
        if (data.kills !== undefined) {
          document.getElementById('kills-value').textContent = data.kills;
        }
        if (data.health !== undefined) {
          updateHealthBar(data.health.current, data.health.max);
        }
      }
      
      // Expose functions to window
      window.updateHUD = updateHUD;
      window.updateHealthBar = updateHealthBar;
    </script>
  </body>
</html>